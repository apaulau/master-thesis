worker(shapiro.test, data, name=name, ...)
}
ntest.PearsonChi2 <- function (data, type, name="", ...) {
worker(pearson.test, data, name=name, ...)
}
ntest.KolmogorovSmirnov <- function (data, type, name="", ...) {
nsample <- rnorm(10000, mean=mean(data), sd=sd(data)) # sample for test against source
worker(ks.test, data, name=name, y=nsample, ...)
}
research.data.shapiro <- ntest.ShapiroWilk(data=research.data$temperature, name="shapiro")
# This module is for tests for normality
library(nortest)  # tests for normality // WANT TO STEAL
worker <- function (test, data, type, name, ...) {
result <- test(data, ...)
if (nchar(name)) {
WriteTest(result$statistic, result$p.value, name)
}
result
}
# Shapiro-Wilk test for normality
ntest.ShapiroWilk <- function (data, type, name="", ...) {
worker(shapiro.test, data, name, ...)
}
ntest.PearsonChi2 <- function (data, type, name="", ...) {
worker(pearson.test, data, name, ...)
}
ntest.KolmogorovSmirnov <- function (data, type, name="", ...) {
nsample <- rnorm(10000, mean=mean(data), sd=sd(data)) # sample for test against source
worker(ks.test, data, name, y=nsample, ...)
}
research.data.shapiro <- ntest.ShapiroWilk(data=research.data$temperature, type="original", name="shapiro")
# This module is for tests for normality
library(nortest)  # tests for normality // WANT TO STEAL
worker <- function (test, data, type, name, ...) {
result <- test(data, ...)
if (nchar(name)) {
WriteTest(result$statistic, result$p.value, name)
}
result
}
# Shapiro-Wilk test for normality
ntest.ShapiroWilk <- function (data, type, name="", ...) {
worker(shapiro.test, data, name=name, ...)
}
ntest.PearsonChi2 <- function (data, type, name="", ...) {
worker(pearson.test, data, name=name, ...)
}
ntest.KolmogorovSmirnov <- function (data, type, name="", ...) {
nsample <- rnorm(10000, mean=mean(data), sd=sd(data)) # sample for test against source
worker(ks.test, data, name=name, y=nsample, ...)
}
research.data.shapiro <- ntest.ShapiroWilk(data=research.data$temperature, type="original", name="shapiro")
# This module is for tests for normality
library(nortest)  # tests for normality // WANT TO STEAL
worker <- function (test, data, type, name, ...) {
result <- test(data, ...)
if (nchar(name)) {
WriteTest(result$statistic, result$p.value, name=name)
}
result
}
# Shapiro-Wilk test for normality
ntest.ShapiroWilk <- function (data, type, name="", ...) {
worker(shapiro.test, data, name=name, ...)
}
ntest.PearsonChi2 <- function (data, type, name="", ...) {
worker(pearson.test, data, name=name, ...)
}
ntest.KolmogorovSmirnov <- function (data, type, name="", ...) {
nsample <- rnorm(10000, mean=mean(data), sd=sd(data)) # sample for test against source
worker(ks.test, data, name=name, y=nsample, ...)
}
research.data.shapiro <- ntest.ShapiroWilk(data=research.data$temperature, type="original", name="shapiro")
# This module is for tests for normality
library(nortest)  # tests for normality // WANT TO STEAL
worker <- function (test, data, type, name, ...) {
result <- test(data, ...)
if (nchar(name)) {
WriteTest(result$statistic, result$p.value, type=type, name=name)
}
result
}
# Shapiro-Wilk test for normality
ntest.ShapiroWilk <- function (data, type, name="", ...) {
worker(shapiro.test, data, type=type, name=name, ...)
}
ntest.PearsonChi2 <- function (data, type, name="", ...) {
worker(pearson.test, data, type=type, name=name, ...)
}
ntest.KolmogorovSmirnov <- function (data, type, name="", ...) {
nsample <- rnorm(10000, mean=mean(data), sd=sd(data)) # sample for test against source
worker(ks.test, data, type=type, name=name, y=nsample, ...)
}
research.data.shapiro <- ntest.ShapiroWilk(data=research.data$temperature, type="original", name="shapiro")
research.data.pearson <- ntest.PearsonChi2(data=research.data$temperature, type="original", name="pearson")
research.data.ks      <- ntest.KolmogorovSmirnov(data=research.data$temperature, type="original", name="ks")
WriteCharacteristic <- function (expression, type, name) {
file <- paste(paste("out", type, "characteristics", name, sep="/"), "tex", sep=".")
writer(expression, file)
}
WriteDescriptiveStatistic <- function (expression, type, name) {
file <- paste(paste("out", type, "descriptive", name, sep="/"), "tex", sep=".")
writer(format(expression, digits=3), file)
}
WriteTest <- function (statistic, p.value, type, name) {
path <- paste("out", type, "test", name, sep="/")
writer(statistic, paste(path, "statistic.tex", sep="/"))
writer(p.value, paste(path, "p-value.tex", sep="/"))
}
writer <- function (expression, file) {
sink(file=file, type="output")
cat(expression)
sink()
}
research.data.dstats <- dstats.describe(research.data$temperature, type="original", locale=TRUE)
format(19.881231, trim=T)
format(19.881231)
format(x-19.881231, trim=T)
format(x=19.881231, trim=T)
print(format(x=19.881231, trim=T))
print(format(x=19.881231, trim=T))
format(x=19.881231, trim=T)
format(19.881231)
format(x=19.881231, width = 3)
format(x=19.881231, width = 1)
format(x=19.881231, justify = "left")
format(24.7483422921075)
format(24.7483422921075, scientific = T)
format(24.7483422921075, nsmall = 3)
format(24.7483422921075, nsmall = 6)
format(24.7483422921075, nsmall = 1)
format(24.7483422921075, nsmall = 2, digits=4)
format(4.7483422921075, nsmall = 2, digits=4)
format(4.7483422921075, nsmall = 3, digits=4)
format(4.7483422921075, nsmall = 1, digits=4)
format(334.7483422921075, nsmall = 1, digits=4)
format(334.7483422921075, nsmall = 3, digits=4)
format(334.7483422921075, nsmall = 2, digits=4)
format(34.7483422921075, nsmall = 2, digits=4)
format(14.7483422921075, nsmall = 2, digits=4)
format(4.7483422921075, nsmall = 2, digits=4)
WriteCharacteristic <- function (expression, type, name) {
file <- paste(paste("out", type, "characteristics", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall = 2, digits=4), file)
}
WriteDescriptiveStatistic <- function (expression, type, name) {
file <- paste(paste("out", type, "descriptive", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall = 2, digits=4), file)
}
WriteTest <- function (statistic, p.value, type, name) {
path <- paste("out", type, "test", name, sep="/")
writer(statistic, paste(path, "statistic.tex", sep="/"))
writer(p.value, paste(path, "p-value.tex", sep="/"))
}
writer <- function (expression, file) {
sink(file=file, type="output")
cat(expression)
sink()
}
research.data.dstats <- dstats.describe(research.data$temperature, type="original", locale=TRUE)
## Import local modules
source("R/lib/plot.R")       # useful functions for more comfortable plotting
source("R/lib/print.R")      # functions for print some data to files
source("R/lib/dstats.R")     # descriptive statistics module
source("R/lib/misc.R")       # some useful global-use functions
source("R/lib/draw.R")       # helpers for drawing
source("R/lib/write.R")      # helpers for writing
source("R/lib/ntest.R")      # tests for normality
## Read the data / pattern: year;temperature
path.data <- "data/batorino_july.csv" # this for future shiny support and may be choosing multiple data sources
src.nrows <- 38
src.data  <- read.csv(file=path.data, header=TRUE, sep=";", nrows=src.nrows, colClasses=c("numeric", "numeric"), stringsAsFactors=FALSE)
## Global use constants
kDateBreaks <- seq(min(src.data$year) - 5, max(src.data$year) + 5, by=2) # date points for graphs
## For the reason of prediction estimation and comparison, let cut observations number by 3
kObservationNum <- length(src.data[, 1]) - 3
WriteCharacteristic(expression=kObservationNum, type="original", name="n")
## Source data as basic time series plot: points connected with line
plot.source <- DrawDataRepresentation(data=src.data, filename="source.png", datebreaks=kDateBreaks)
print(xtable(src.data, caption="Исходные данные.", label="table:source"),  table.placement="H",
file="out/original/data.tex")
## Form the data for research
research.data <- src.data[0:kObservationNum, ]
# Getting descriptive statistics for temperature in russian locale
research.data.dstats <- dstats.describe(research.data$temperature, type="original", locale=TRUE)
## Cleaning up the workspace
rm(list=ls(all=TRUE))
## Dependencies
library(ggplot2)  # eye-candy graphs
library(xtable)   # convert data to latex tables
library(outliers) # tests for outliers
library(tseries)  # adf test used
library(nortest)  # tests for normality
library(sp)       # spatial data
library(gstat)    # geostatistics
library(reshape2) # will see
## Import local modules
source("R/lib/plot.R")       # useful functions for more comfortable plotting
source("R/lib/print.R")      # functions for print some data to files
source("R/lib/dstats.R")     # descriptive statistics module
source("R/lib/misc.R")       # some useful global-use functions
source("R/lib/draw.R")       # helpers for drawing
source("R/lib/write.R")      # helpers for writing
source("R/lib/ntest.R")      # tests for normality
## Read the data / pattern: year;temperature
path.data <- "data/batorino_july.csv" # this for future shiny support and may be choosing multiple data sources
src.nrows <- 38
src.data  <- read.csv(file=path.data, header=TRUE, sep=";", nrows=src.nrows, colClasses=c("numeric", "numeric"), stringsAsFactors=FALSE)
## Global use constants
kDateBreaks <- seq(min(src.data$year) - 5, max(src.data$year) + 5, by=2) # date points for graphs
## For the reason of prediction estimation and comparison, let cut observations number by 3
kObservationNum <- length(src.data[, 1]) - 3
WriteCharacteristic(expression=kObservationNum, type="original", name="n")
## Source data as basic time series plot: points connected with line
plot.source <- DrawDataRepresentation(data=src.data, filename="source.png", datebreaks=kDateBreaks)
print(xtable(src.data, caption="Исходные данные.", label="table:source"),  table.placement="H",
file="out/original/data.tex")
## Form the data for research
research.data <- src.data[0:kObservationNum, ]
# Getting descriptive statistics for temperature in russian locale
research.data.dstats <- dstats.describe(research.data$temperature, type="original", locale=TRUE)
rm(list=ls(all=TRUE))
## Dependencies
library(ggplot2)  # eye-candy graphs
library(xtable)   # convert data to latex tables
library(outliers) # tests for outliers
library(tseries)  # adf test used
library(nortest)  # tests for normality
library(sp)       # spatial data
library(gstat)    # geostatistics
library(reshape2) # will see
## Import local modules
source("R/lib/plot.R")       # useful functions for more comfortable plotting
source("R/lib/print.R")      # functions for print some data to files
source("R/lib/dstats.R")     # descriptive statistics module
source("R/lib/misc.R")       # some useful global-use functions
source("R/lib/draw.R")       # helpers for drawing
source("R/lib/write.R")      # helpers for writing
source("R/lib/ntest.R")      # tests for normality
## Read the data / pattern: year;temperature
path.data <- "data/batorino_july.csv" # this for future shiny support and may be choosing multiple data sources
src.nrows <- 38
src.data  <- read.csv(file=path.data, header=TRUE, sep=";", nrows=src.nrows, colClasses=c("numeric", "numeric"), stringsAsFactors=FALSE)
## Global use constants
kDateBreaks <- seq(min(src.data$year) - 5, max(src.data$year) + 5, by=2) # date points for graphs
## For the reason of prediction estimation and comparison, let cut observations number by 3
kObservationNum <- length(src.data[, 1]) - 3
WriteCharacteristic(expression=kObservationNum, type="original", name="n")
## Source data as basic time series plot: points connected with line
plot.source <- DrawDataRepresentation(data=src.data, filename="source.png", datebreaks=kDateBreaks)
print(xtable(src.data, caption="Исходные данные.", label="table:source"),  table.placement="H",
file="out/original/data.tex")
## Form the data for research
research.data <- src.data[0:kObservationNum, ]
# Getting descriptive statistics for temperature in russian locale
research.data.dstats <- dstats.describe(research.data$temperature, type="original", locale=TRUE)
print(xtable(research.data.dstats, caption="Описательные статистики для наблюдаемых температур.", label="table:dstats"),
file="out/original/dstats.tex")
WriteCharacteristic <- function (expression, type, name) {
file <- paste(paste("out", type, "characteristics", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteDescriptiveStatistic <- function (expression, type, name) {
file <- paste(paste("out", type, "descriptive", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteTest <- function (statistic, p.value, type, name) {
path <- paste("out", type, "test", name, sep="/")
writer(format(statistic, nsmall=2, digits=4), paste(path, "statistic.tex", sep="/"))
writer(format(p.value, nsmall=2, digits=4), paste(path, "p-value.tex", sep="/"))
}
writer <- function (expression, file) {
sink(file=file, type="output")
cat(expression)
sink()
}
library(ggplot2)  # eye-candy graphs
library(xtable)   # convert data to latex tables
library(outliers) # tests for outliers
library(tseries)  # adf test used
library(nortest)  # tests for normality
library(sp)       # spatial data
library(gstat)    # geostatistics
library(reshape2) # will see
## Import local modules
source("R/lib/plot.R")       # useful functions for more comfortable plotting
source("R/lib/print.R")      # functions for print some data to files
source("R/lib/dstats.R")     # descriptive statistics module
source("R/lib/misc.R")       # some useful global-use functions
source("R/lib/draw.R")       # helpers for drawing
source("R/lib/write.R")      # helpers for writing
source("R/lib/ntest.R")      # tests for normality
## Read the data / pattern: year;temperature
path.data <- "data/batorino_july.csv" # this for future shiny support and may be choosing multiple data sources
src.nrows <- 38
src.data  <- read.csv(file=path.data, header=TRUE, sep=";", nrows=src.nrows, colClasses=c("numeric", "numeric"), stringsAsFactors=FALSE)
## Global use constants
kDateBreaks <- seq(min(src.data$year) - 5, max(src.data$year) + 5, by=2) # date points for graphs
## For the reason of prediction estimation and comparison, let cut observations number by 3
kObservationNum <- length(src.data[, 1]) - 3
WriteCharacteristic(expression=kObservationNum, type="original", name="n")
## Source data as basic time series plot: points connected with line
plot.source <- DrawDataRepresentation(data=src.data, filename="source.png", datebreaks=kDateBreaks)
print(xtable(src.data, caption="Исходные данные.", label="table:source"),  table.placement="H",
file="out/original/data.tex")
## Form the data for research
research.data <- src.data[0:kObservationNum, ]
# Getting descriptive statistics for temperature in russian locale
research.data.dstats <- dstats.describe(research.data$temperature, type="original", locale=TRUE)
print(xtable(research.data.dstats, caption="Описательные статистики для наблюдаемых температур.", label="table:dstats"),
file="out/original/dstats.tex")
# Compute Sturges rule for output
WriteCharacteristic(expression=nclass.Sturges(research.data$temperature), type="original", name="sturges")
## Basic histogram based on Sturges rule (by default) with pretty output (also by default)
plot.data.hist <- DrawHistogram(data=research.data, filename="original/histogram.png")
## Tests for normality
research.data.shapiro <- ntest.ShapiroWilk(data=research.data$temperature, type="original", name="shapiro")
research.data.pearson <- ntest.PearsonChi2(data=research.data$temperature, type="original", name="pearson")
research.data.ks      <- ntest.KolmogorovSmirnov(data=research.data$temperature, type="original", name="ks")
research.data.grubbs <- grubbs.test(research.data$temperature)
WriteTest(research.data.grubbs$statistic, research.data.grubbs$p.value, type="original", name="grubbs")
cor(research.data)
cor(research.data$year, research.data$temperature)
cor(x=research.data$year, y=research.data$temperature)
research.data.correlation <- cor(x=research.data$year, y=research.data$temperature)
WriteCharacteristic(research.data.correlation, type="original", name="correlation")
WriteCharacteristic <- function (expression, type, name) {
file <- paste(paste("out", type, "characteristics", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteDescriptiveStatistic <- function (expression, type, name) {
file <- paste(paste("out", type, "descriptive", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteTest <- function (statistic, p.value, df=-1, type, name) {
path <- paste("out", type, "test", name, sep="/")
writer(format(statistic, nsmall=2, digits=2), paste(path, "statistic.tex", sep="/"))
writer(format(p.value, nsmall=2, digits=2), paste(path, "p-value.tex", sep="/"))
if (df != -1) {
writer(format(df, nsmall=2, digits=2), paste(path, "df.tex", sep="/"))
}
}
writer <- function (expression, file) {
sink(file=file, type="output")
cat(expression)
sink()
}
research.data.ctest <- cor.test(research.data$temperature, c(1:kObservationNum), method="pearson")
WriteTest(research.data.ctest$statistic, research.data.ctest$p.value, research.data.ctest$df, type="original", name="correlation")
WriteTest(research.data.ctest$statistic, research.data.ctest$p.value, research.data.ctest$df, type="original", name="correlation")
df <- -1
df != -1
WriteCharacteristic <- function (expression, type, name) {
file <- paste(paste("out", type, "characteristics", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteDescriptiveStatistic <- function (expression, type, name) {
file <- paste(paste("out", type, "descriptive", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteTest <- function (statistic, p.value, df=NA, type, name) {
path <- paste("out", type, "test", name, sep="/")
writer(format(statistic, nsmall=2, digits=2), paste(path, "statistic.tex", sep="/"))
writer(format(p.value, nsmall=2, digits=2), paste(path, "p-value.tex", sep="/"))
if (df) {
writer(format(df, nsmall=2, digits=2), paste(path, "df.tex", sep="/"))
}
}
writer <- function (expression, file) {
sink(file=file, type="output")
cat(expression)
sink()
}
WriteTest(research.data.ctest$statistic, research.data.ctest$p.value, research.data.ctest$df, type="original", name="correlation")
research.data.ctest <- cor.test(research.data$temperature, c(1:kObservationNum), method="pearson")
research.data$df
research.data.ctest
research.data.ctest$conf.int
research.data.ctest$parameter
research.data.ctest$parameter[[1]]
WriteTest(research.data.ctest$statistic, research.data.ctest$p.value, research.data.ctest$parameter[[1]], type="original", name="correlation")
research.data.correlation <- cor(x=research.data$year, y=research.data$temperature)
WriteCharacteristic(research.data.correlation, type="original", name="correlation")
sapply(X=ConvertYearsToNum(src.data$year[kObservationNum:src.nrows]), FUN=linear, a=coef(research.data.fit)[2], b=coef(research.data.fit)[1])
linear <- function(x, a, b) a * x + b
sapply(X=ConvertYearsToNum(src.data$year[kObservationNum:src.nrows]), FUN=linear, a=coef(research.data.fit)[2], b=coef(research.data.fit)[1])
research.data.fit <- lm(research.data$temperature ~ c(1:kObservationNum))
sapply(X=ConvertYearsToNum(src.data$year[kObservationNum:src.nrows]), FUN=linear, a=coef(research.data.fit)[2], b=coef(research.data.fit)[1])
ConvertYearsToNum(src.data$year[kObservationNum:src.nrows])
src.data$year[kObservationNum:src.nrows]
research.data.fit$coefficients[1]
coef(research.data.fit)[1]
research.data.fit$coefficients[[1]]
research.residuals.prediction.trend <- data.frame("Год"=src.data$year[(kObservationNum + 1):src.nrows],
"Актуальное значение"=src.data$year[(kObservationNum + 1):src.nrows,
"Прогнозное значение"=sapply(X=ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows]), FUN=linear, a=research.data.fit$coefficients[[2]], b=research.data.fit$coefficients[[1]]))
research.residuals.prediction.trend <- data.frame("Год"=src.data$year[(kObservationNum + 1):src.nrows],
"Актуальное значение"=src.data$year[(kObservationNum + 1):src.nrows,
"Прогнозное значение"=sapply(X=ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows]), FUN=linear, a=research.data.fit$coefficients[[2]], b=research.data.fit$coefficients[[1]])
)
linear <- function(x, a, b) a * x + b
research.residuals.prediction.trend <- data.frame("Год"=src.data$year[(kObservationNum + 1):src.nrows],
"Актуальное значение"=src.data$year[(kObservationNum + 1):src.nrows,
"Прогнозное значение"=sapply(X=ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows]),
FUN=linear,
a=research.data.fit$coefficients[[2]],
b=research.data.fit$coefficients[[1]]
)
)
ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows])
research.data.fit$coefficients[[2]]
research.data.fit$coefficients[[1]]
research.residuals.prediction.trend <- data.frame("Год"=src.data$year[(kObservationNum + 1):src.nrows],
"Актуальное значение"=src.data$year[(kObservationNum + 1):src.nrows],
"Прогнозное значение"=sapply(X=ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows]),
FUN=linear,
a=research.data.fit$coefficients[[2]],
b=research.data.fit$coefficients[[1]]
)
)
research.residuals.prediction.trend
research.residuals.prediction.trend <- data.frame("Год"=src.data$year[(kObservationNum + 1):src.nrows],
"Актуальное значение"=src.data$temperature[(kObservationNum + 1):src.nrows],
"Прогнозное значение"=sapply(X=ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows]), FUN=linear, a=research.data.fit$coefficients[[2]], b=research.data.fit$coefficients[[1]]))
research.residuals.prediction.trend
data.frame("Год"=src.data$year[(kObservationNum + 1):src.nrows],
"Актуальное"=src.data$temperature[(kObservationNum + 1):src.nrows],
"Прогнозное"=sapply(X=ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows]), FUN=linear, a=research.data.fit$coefficients[[2]], b=research.data.fit$coefficients[[1]]))
print(xtable(research.residuals.prediction.trend, caption="Сравнение прогнозных значений", label="table:prediction_trend"),
file="out/residual/prediction-trend.tex")
linear <- function(x, a, b) a * x + b
research.residuals.prediction.trend <- data.frame("Год"=src.data$year[(kObservationNum + 1):src.nrows],
"Актуальное"=src.data$temperature[(kObservationNum + 1):src.nrows],
"Прогнозное"=sapply(X=ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows]), FUN=linear, a=research.data.fit$coefficients[[2]], b=research.data.fit$coefficients[[1]]))
print(xtable(research.residuals.prediction.trend, caption="Сравнение прогнозных значений", label="table:prediction_trend"),
file="out/residual/prediction-trend.tex")
src.data$year[(kObservationNum + 1):src.nrows]
research.residuals.prediction.trend <- data.frame("Год"=src.data$year[(kObservationNum + 1):src.nrows],
"Актуальное"=src.data$temperature[(kObservationNum + 1):src.nrows],
"Прогнозное"=sapply(X=ConvertYearsToNum(src.data$year[(kObservationNum + 1):src.nrows]), FUN=linear, a=research.data.fit$coefficients[[2]], b=research.data.fit$coefficients[[1]]))
print(xtable(research.residuals.prediction.trend, caption="Сравнение прогнозных значений", label="table:prediction_trend", digits=c(0, 2, 2)),
file="out/residual/prediction-trend.tex")
print(xtable(research.residuals.prediction.trend, caption="Сравнение прогнозных значений", label="table:prediction_trend", digits=c(0, 0, 2, 2)),
file="out/residual/prediction-trend.tex")
research.residuals <- data.frame("year"=research.data$year, "temperature"=research.data.fit$residuals)
print(xtable(research.residuals, caption="Временной ряд остатков.", label="table:residuals"), table.placement="H",
file="out/residual/data.tex")
research.residuals.dstats <- dstats.describe(research.residuals$temperature, type="residual", locale=TRUE)
print(xtable(research.residuals.dstats, caption="Описательные статистики остатков", label="table:residuals_dstats"),
file="out/residual/dstats.tex")
plot.residuals.hist <- DrawHistogram(data=research.residuals, filename="residual/histogram.png")
## Tests for normality
research.data.shapiro <- ntest.ShapiroWilk(data=research.residuals$temperature, type="residual", name="shapiro")
research.data.shapiro <- ntest.ShapiroWilk(data=research.residuals$temperature, type="residual", name="shapiro")
WriteCharacteristic <- function (expression, type, name) {
file <- paste(paste("out", type, "characteristics", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteDescriptiveStatistic <- function (expression, type, name) {
file <- paste(paste("out", type, "descriptive", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteTest <- function (statistic, p.value, df=NA, type, name) {
path <- paste("out", type, "test", name, sep="/")
writer(format(statistic, nsmall=2, digits=2), paste(path, "statistic.tex", sep="/"))
writer(format(p.value, nsmall=2, digits=2), paste(path, "p-value.tex", sep="/"))
if (df != NA) {
writer(format(df, nsmall=2, digits=2), paste(path, "df.tex", sep="/"))
}
}
writer <- function (expression, file) {
sink(file=file, type="output")
cat(expression)
sink()
}
research.data.shapiro <- ntest.ShapiroWilk(data=research.residuals$temperature, type="residual", name="shapiro")
WriteCharacteristic <- function (expression, type, name) {
file <- paste(paste("out", type, "characteristics", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteDescriptiveStatistic <- function (expression, type, name) {
file <- paste(paste("out", type, "descriptive", name, sep="/"), "tex", sep=".")
writer(format(expression, nsmall=2, digits=3), file)
}
WriteTest <- function (statistic, p.value, df=FALSE, type, name) {
path <- paste("out", type, "test", name, sep="/")
writer(format(statistic, nsmall=2, digits=2), paste(path, "statistic.tex", sep="/"))
writer(format(p.value, nsmall=2, digits=2), paste(path, "p-value.tex", sep="/"))
if (df) {
writer(format(df, nsmall=2, digits=2), paste(path, "df.tex", sep="/"))
}
}
writer <- function (expression, file) {
sink(file=file, type="output")
cat(expression)
sink()
}
research.data.shapiro <- ntest.ShapiroWilk(data=research.residuals$temperature, type="residual", name="shapiro")
research.data.pearson <- ntest.PearsonChi2(data=research.residuals$temperature, type="residual", name="pearson")
research.data.ks      <- ntest.KolmogorovSmirnov(data=research.residuals$temperature, type="residual", name="ks")
## Normal Quantile-Quantile plot for residuals
plot.residuals.qq <- DrawQuantileQuantile(data=research.residuals$temperature, filename="residual/quantile.png")
## Auto Correlation Function plot
plot.residuals.acf <- DrawAutoCorrelationFunction(data=research.data$temperature, filename="residual/acf.png")
## Box-Ljung and adf tests (some kind of stationarity and independence tests) // TODO: need to know exactly in theory what it is
research.residuals.box <- Box.test(research.residuals$temperature, type="Ljung-Box")
WriteTest(research.data.box$statistic, research.data.box$p.value, research.data.box$parameter[[1]], type="residual", name="ljung-box")
WriteTest(research.residuals.box$statistic, research.residuals.box$p.value, research.residuals.box$parameter[[1]], type="residual", name="ljung-box")
research.residuals.adf <- adf.test(research.residuals$temperature)
WriteTest(research.residuals.adf$statistic, research.residuals.adf$p.value, type="residual", name="stationarity")
adf.test(research.residuals$temperature)
adf.test(research.residuals$temperature)
